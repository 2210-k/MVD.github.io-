<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>МВД РФ - Служебный портал</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary: #0f766e;
            --accent: #dc2626;
            --accent-light: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --sidebar-width: 260px;
            --header-height: 70px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
        }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 1rem;
        }
        
        .logo i {
            font-size: 2rem;
        }
        
        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .nav-item {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.15);
            border-left: 4px solid white;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            height: var(--header-height);
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            position: sticky;
            top: 0;
            z-index: 99;
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .current-date {
            background-color: var(--light);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 500;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .day-counter {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: var(--light);
            padding: 0.5rem 1rem;
            border-radius: 50px;
        }
        
        .day-counter button {
            background: none;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .day-counter button:hover {
            background-color: var(--light-gray);
        }
        
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            border-top: 4px solid var(--primary);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* Cards */
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 1.25rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: var(--light);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background-color: white;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background-color: var(--accent);
        }
        
        .btn-danger:hover {
            background-color: var(--accent-light);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .btn-warning {
            background-color: var(--warning);
        }
        
        .btn-warning:hover {
            background-color: #d97706;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .form-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .flex {
            display: flex;
            gap: 1rem;
        }
        
        .flex-1 {
            flex: 1;
        }
        
        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--light-gray);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }
        
        th {
            background-color: var(--light);
            font-weight: 600;
            color: var(--dark);
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: var(--light);
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .action-buttons .btn {
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
        }
        
        /* Search & Filters */
        .search-box {
            margin-bottom: 1rem;
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .search-box input {
            padding-left: 40px;
        }
        
        /* Accordion */
        .accordion {
            margin-bottom: 1rem;
        }
        
        .accordion-header {
            background-color: var(--light);
            padding: 0.75rem 1rem;
            cursor: pointer;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .accordion-header:hover {
            background-color: #f1f5f9;
        }
        
        .accordion-content {
            padding: 1rem;
            border: 1px solid var(--light-gray);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            background-color: white;
        }
        
        /* Codex Items */
        .codex-section {
            margin-bottom: 1rem;
        }
        
        .codex-item {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid var(--light-gray);
            transition: background-color 0.2s;
            border-radius: 4px;
        }
        
        .codex-item:hover {
            background-color: var(--light);
        }
        
        /* Alerts */
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        
        .alert-error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        
        /* Status Badges */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .status-active {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-inactive {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        /* Categories */
        .categories {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .category {
            background-color: #e0f2fe;
            color: #0369a1;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.875rem;
        }
        
        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--light-gray);
        }
        
        /* Reports */
        .report-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary);
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .report-meta {
            color: var(--gray);
            font-size: 0.875rem;
        }
        
        .report-content {
            margin-bottom: 1rem;
        }
        
        .report-section {
            margin-bottom: 1rem;
        }
        
        .report-label {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .report-value {
            margin-bottom: 0.5rem;
        }
        
        /* Login */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            padding: 2rem;
        }
        
        .login-card {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            width: 100%;
            max-width: 420px;
            text-align: center;
        }
        
        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 1.5rem;
        }
        
        .login-logo i {
            font-size: 2.5rem;
            color: var(--primary);
        }
        
        .login-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .login-subtitle {
            color: var(--gray);
            margin-bottom: 2rem;
        }
        
        /* Hidden */
        .hidden {
            display: none !important;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 80px;
                overflow: visible;
            }
            
            .sidebar-header .logo-text,
            .nav-item span {
                display: none;
            }
            
            .nav-item {
                justify-content: center;
                padding: 1.25rem;
            }
            
            .main-content {
                margin-left: 80px;
            }
            
            .header-title {
                font-size: 1.25rem;
            }
        }
        
        @media (max-width: 768px) {
            .flex {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 0 1rem;
            }
            
            .content {
                padding: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar {
                width: 0;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-btn {
                display: block;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="login-screen">
        <div class="login-card">
            <div class="login-logo">
                <i class="fas fa-shield-alt"></i>
                <span class="logo-text">МВД РФ</span>
            </div>
            <h1 class="login-title">Служебный портал</h1>
            <p class="login-subtitle">Введите пароль для доступа к системе</p>
            
            <div class="form-group">
                <input type="password" id="password-input" placeholder="Пароль" class="login-input">
            </div>
            
            <button class="btn" id="login-btn" style="width: 100%;">
                <i class="fas fa-sign-in-alt"></i> Войти в систему
            </button>
            
            <div id="login-error" class="alert alert-error hidden" style="margin-top: 1rem;">
                <i class="fas fa-exclamation-circle"></i> Неверный пароль! Попробуйте снова.
            </div>
            
            <div style="margin-top: 2rem; font-size: 0.875rem; color: var(--gray);">
                <p>Пароль для доступа: <strong>121212</strong></p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div class="app-container hidden" id="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-shield-alt"></i>
                    <span class="logo-text">МВД РФ</span>
                </div>
            </div>
            
            <div class="nav-items">
                <div class="nav-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Главная</span>
                </div>
                <div class="nav-item" data-section="actions">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Реестр действий</span>
                </div>
                <div class="nav-item" data-section="licenses">
                    <i class="fas fa-id-card"></i>
                    <span>Водительские удостоверения</span>
                </div>
                <div class="nav-item" data-section="reports">
                    <i class="fas fa-file-alt"></i>
                    <span>Отчеты</span>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <h1 class="header-title" id="page-title">Главная панель</h1>
                
                <div class="header-actions">
                    <div class="current-date">
                        <i class="fas fa-calendar-alt"></i>
                        <span id="current-date">04 августа 2025 года</span>
                    </div>
                    
                    <div class="day-counter">
                        <button id="decrease-day">-</button>
                        <span>Игровой день: <strong id="game-day">1</strong></span>
                        <button id="increase-day">+</button>
                    </div>
                </div>
            </div>
            
            <!-- Content -->
            <div class="content">
                <!-- Dashboard Section -->
                <div class="content-section active" id="dashboard-section">
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-value" id="total-actions">0</div>
                            <div class="stat-label">Всего действий</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-licenses">0</div>
                            <div class="stat-label">ВУ в базе</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="active-licenses">0</div>
                            <div class="stat-label">Действующих ВУ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="expired-licenses">0</div>
                            <div class="stat-label">Просроченных ВУ</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-bolt"></i> Быстрые действия</h2>
                        </div>
                        
                        <div class="flex">
                            <button class="btn btn-outline" id="quick-vehicle-btn">
                                <i class="fas fa-car"></i> Остановка ТС
                            </button>
                            <button class="btn btn-outline" id="quick-pedestrian-btn">
                                <i class="fas fa-user"></i> Оформление гражданина
                            </button>
                            <button class="btn btn-outline" id="quick-arrest-btn">
                                <i class="fas fa-handcuffs"></i> Оформление ареста
                            </button>
                            <button class="btn btn-outline" id="quick-accident-btn">
                                <i class="fas fa-car-crash"></i> Оформление ДТП
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-history"></i> Последние действия</h2>
                        </div>
                        
                        <div class="table-container">
                            <table id="recent-actions-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Дата</th>
                                        <th>Тип</th>
                                        <th>Действие</th>
                                        <th>Объект</th>
                                        <th>Инспектор</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Данные будут заполняться через JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div id="recent-actions-empty" class="empty-state hidden">
                            <i class="fas fa-clipboard-list"></i>
                            <h3>Нет последних действий</h3>
                            <p>Совершите первое действие, используя кнопки выше.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Actions Section -->
                <div class="content-section" id="actions-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-clipboard-list"></i> Реестр служебных действий</h2>
                            <div class="flex">
                                <select id="action-type-select">
                                    <option value="vehicle">Остановка ТС</option>
                                    <option value="pedestrian">Оформление гражданина</option>
                                    <option value="arrest">Оформление ареста</option>
                                    <option value="accident">Оформление ДТП</option>
                                </select>
                                <button class="btn" id="new-action-btn">
                                    <i class="fas fa-plus"></i> Создать действие
                                </button>
                            </div>
                        </div>
                        
                        <!-- Формы для разных типов действий будут добавляться здесь -->
                        <div id="action-forms-container">
                            <!-- Формы будут добавляться динамически -->
                        </div>
                        
                        <div class="table-container">
                            <table id="actions-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Дата</th>
                                        <th>Тип</th>
                                        <th>Действие</th>
                                        <th>Статья</th>
                                        <th>Объект</th>
                                        <th>Инспектор</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Данные будут заполняться через JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div id="actions-empty" class="empty-state">
                            <i class="fas fa-clipboard-list"></i>
                            <h3>Нет записей о действиях</h3>
                            <p>Начните работу, создав новое действие.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Licenses Section -->
                <div class="content-section" id="licenses-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-id-card"></i> Реестр водительских удостоверений</h2>
                            <div class="flex">
                                <button class="btn" id="add-license-btn">
                                    <i class="fas fa-plus"></i> Добавить ВУ
                                </button>
                                <div class="search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="license-search" placeholder="Поиск по номеру ВУ или паспорта...">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Форма добавления/редактирования ВУ -->
                        <div id="license-form" class="hidden">
                            <form id="license-data-form">
                                <div class="form-section">
                                    <h3 class="card-title"><i class="fas fa-info-circle"></i> Основные данные</h3>
                                    <div class="form-group">
                                        <label for="license-id">Уникальный номер ВУ</label>
                                        <input type="text" id="license-id" readonly>
                                    </div>
                                    
                                    <div class="flex">
                                        <div class="form-group flex-1">
                                            <label for="license-name">Имя *</label>
                                            <input type="text" id="license-name" required>
                                        </div>
                                        <div class="form-group flex-1">
                                            <label for="license-patronymic">Отчество *</label>
                                            <input type="text" id="license-patronymic" required>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="license-passport">№ Паспорта *</label>
                                        <input type="text" id="license-passport" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="license-number">№ Водительского удостоверения *</label>
                                        <input type="text" id="license-number" required>
                                    </div>
                                </div>
                                
                                <div class="form-section">
                                    <h3 class="card-title"><i class="fas fa-calendar-check"></i> Срок действия</h3>
                                    <div class="flex">
                                        <div class="form-group flex-1">
                                            <label for="license-issue-date">Дата выдачи (ДД.ММ.ГГ) *</label>
                                            <input type="text" id="license-issue-date" placeholder="ДД.ММ.ГГ" required>
                                        </div>
                                        <div class="form-group flex-1">
                                            <label for="license-issue-game-day">Игровой день выдачи *</label>
                                            <input type="number" id="license-issue-game-day" min="0" max="10000" required>
                                        </div>
                                    </div>
                                    
                                    <div class="flex">
                                        <div class="form-group flex-1">
                                            <label for="license-valid-date">Действительно до (ДД.ММ.ГГ) *</label>
                                            <input type="text" id="license-valid-date" placeholder="ДД.ММ.ГГ" required>
                                        </div>
                                        <div class="form-group flex-1">
                                            <label for="license-valid-game-day">Игровой день окончания *</label>
                                            <input type="number" id="license-valid-game-day" min="0" max="10000" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-section">
                                    <h3 class="card-title"><i class="fas fa-cogs"></i> Дополнительные сведения</h3>
                                    <div class="form-group">
                                        <label>Категории *</label>
                                        <div class="categories">
                                            <label><input type="checkbox" name="license-category" value="A"> A</label>
                                            <label><input type="checkbox" name="license-category" value="A1"> A1</label>
                                            <label><input type="checkbox" name="license-category" value="M"> M</label>
                                            <label><input type="checkbox" name="license-category" value="B"> B</label>
                                            <label><input type="checkbox" name="license-category" value="B1"> B1</label>
                                            <label><input type="checkbox" name="license-category" value="C"> C</label>
                                            <label><input type="checkbox" name="license-category" value="D"> D</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn"><i class="fas fa-save"></i> Сохранить ВУ</button>
                                    <button type="button" class="btn btn-danger" id="cancel-license-btn"><i class="fas fa-times"></i> Отмена</button>
                                </div>
                            </form>
                        </div>
                        
                        <div class="table-container">
                            <table id="licenses-table">
                                <thead>
                                    <tr>
                                        <th>№ ВУ</th>
                                        <th>Владелец</th>
                                        <th>№ Паспорта</th>
                                        <th>Дата выдачи</th>
                                        <th>Действительно до</th>
                                        <th>Категории</th>
                                        <th>Статус</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Данные будут заполняться через JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div id="licenses-empty" class="empty-state">
                            <i class="fas fa-id-card"></i>
                            <h3>Нет водительских удостоверений</h3>
                            <p>Добавьте первое водительское удостоверение.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Reports Section -->
                <div class="content-section" id="reports-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-file-alt"></i> Отчеты</h2>
                            <div class="flex">
                                <button class="btn" id="generate-arrest-report-btn">
                                    <i class="fas fa-handcuffs"></i> Отчет об арестах
                                </button>
                                <button class="btn" id="generate-accident-report-btn">
                                    <i class="fas fa-car-crash"></i> Отчет о ДТП
                                </button>
                                <button class="btn" id="generate-license-report-btn">
                                    <i class="fas fa-id-card"></i> Отчет по ВУ
                                </button>
                            </div>
                        </div>
                        
                        <div id="reports-container">
                            <!-- Отчеты будут добавляться здесь -->
                        </div>
                        
                        <div id="reports-empty" class="empty-state">
                            <i class="fas fa-file-alt"></i>
                            <h3>Нет сформированных отчетов</h3>
                            <p>Используйте кнопки выше для формирования отчетов.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Данные кодексов
        const roadCode = [
            { article: "1.1.1", violation: "Управление ТС без водительского удостоверения", penalty: "5000-20000" },
            { article: "1.1.2", violation: "Управление ТС водителем, лишенным права управления", penalty: "25000 или арест" },
            { article: "1.2.1", violation: "Управление ТС в состоянии алкогольного или иного опьянения", penalty: "10000 + лишение права" },
            { article: "1.2.2", violation: "Управление ТС в состоянии опьянения без прав или лишенным прав", penalty: "30000 или арест" },
            { article: "1.2.3", violation: "Отказ от медицинского освидетельствования на состояние опьянения", penalty: "30000 + лишение права" },
            { article: "1.3", violation: "Управление технически неисправным ТС", penalty: "500-1500 + эвакуация" },
            { article: "1.4", violation: "Управление ТС без действующего полиса ОСАГО", penalty: "3000" },
            { article: "1.5", violation: "Управление ТС без регистрационных документов", penalty: "4500 + задержание ТС" },
            { article: "2.1.1", violation: "Превышение скорости на 20-40 км/ч", penalty: "500" },
            { article: "2.1.2", violation: "Превышение скорости на 40-60 км/ч", penalty: "1000-1500" },
            { article: "2.1.3", violation: "Превышение скорости на 60-80 км/ч", penalty: "2000-2500 или лишение права" },
            { article: "2.1.4", violation: "Превышение скорости более чем на 80 км/ч", penalty: "5000 или лишение права" },
            { article: "2.1.5", violation: "Повторное нарушение правил скоростного ограничения", penalty: "5500 + лишение права" },
            { article: "2.2", violation: "Движение без необходимости со слишком малой скоростью", penalty: "1000-1500" },
            { article: "3.1", violation: "Выезд на встречную полосу для объезда препятствия", penalty: "1500-2000" },
            { article: "3.2.1", violation: "Выезд на встречную полосу НЕ для объезда препятствия", penalty: "5000 или лишение права" },
            { article: "3.2.2", violation: "Повторный выезд на встречную полосу НЕ для объезда препятствия", penalty: "6000 + лишение права" },
            { article: "3.3", violation: "Несоблюдение требований, предписанных дорожными знаками или разметкой", penalty: "1000-1500" },
            { article: "3.4", violation: "Нарушение правил расположения ТС на проезжей части", penalty: "1500" },
            { article: "3.5", violation: "Нарушение правил остановки или стоянки", penalty: "2000-3500" },
            { article: "3.6", violation: "Опасное вождение", penalty: "5000" },
            { article: "3.7", violation: "Нарушение правил проезда перекрестков", penalty: "1000" },
            { article: "3.8", violation: "Невыполнение требования ПДД уступить дорогу", penalty: "1500-2500" },
            { article: "3.9", violation: "Нарушение правил поворота или разворота", penalty: "1000-1500" },
            { article: "3.10", violation: "Невключение или несвоевременное выключение указателей поворота", penalty: "500" },
            { article: "3.11", violation: "Движение задним ходом в запрещенных местах", penalty: "2000" },
            { article: "4.1.1", violation: "Участие в ДТП (с причинением легкого/среднего вреда здоровью)", penalty: "5000-15000 или лишение права" },
            { article: "4.1.2", violation: "Оставление места ДТП участником", penalty: "20000 + лишение права" },
            { article: "4.2", violation: "Негорящие (неисправные) фары и габаритные огни", penalty: "500" },
            { article: "4.3", violation: "Нарушение правил перевозки грузов", penalty: "1500-2000" },
            { article: "4.4", violation: "Загрязнение номерных знаков", penalty: "500" },
            { article: "5.1.1", violation: "Невыполнение законного требования сотрудника полиции", penalty: "1500-2000" },
            { article: "5.1.2", violation: "Невыполнение законного требования сотрудника полиции об остановке ТС", penalty: "2000-2500" },
            { article: "5.2", violation: "Оказание сопротивления или неповиновение законному распоряжению сотрудника полиции", penalty: "3000-5000 или арест" }
        ];

        const administrativeCode = [
            { article: "1.1", violation: "Оскорбление, унижение чести в отношении гражданского лица", penalty: "7000-10000" },
            { article: "1.2", violation: "Клевета", penalty: "10000-12000" },
            { article: "1.3", violation: "Дискриминация", penalty: "10000" },
            { article: "1.4", violation: "Мелкое хулиганство", penalty: "5000" },
            { article: "1.5", violation: "Порча госдокумента", penalty: "5000-10000" },
            { article: "2.1", violation: "Организация несанкционированного публичного собрания", penalty: "20000 и арест" },
            { article: "2.2", violation: "Участие в несанкционированном публичном собрании", penalty: "5000 или арест" },
            { article: "2.3", violation: "Громкое прослушивание музыки после 23:00", penalty: "6500" },
            { article: "2.4", violation: "Организация блокирования транспортных коммуникаций", penalty: "12500" },
            { article: "2.5", violation: "Нарушение правил перевозки оружия", penalty: "20000 и конфискация" },
            { article: "2.6", violation: "Нарушение общественного порядка", penalty: "8000 или арест" },
            { article: "3.1", violation: "Заведомо ложный вызов специализированных служб", penalty: "30000" },
            { article: "3.2", violation: "Применение насилия в отношении представителя власти", penalty: "10000 и арест" },
            { article: "3.3", violation: "Оскорбление представителя власти", penalty: "15000" }
        ];

        const criminalCode = [
            { article: "1.1", violation: "Убийство", penalty: "Пожизненное лишение свободы" },
            { article: "1.2", violation: "Убийство по неосторожности", penalty: "Лишение свободы на 5 лет" },
            { article: "1.3", violation: "Умышленное причинение тяжкого вреда здоровью", penalty: "Лишение свободы на 3 года" },
            { article: "1.4", violation: "Умышленное причинение средней тяжести вреда здоровью", penalty: "Лишение свободы на 2 года" },
            { article: "1.5", violation: "Умышленное причинение легкого вреда здоровью", penalty: "Лишение свободы на 1 год" },
            { article: "1.6", violation: "Побои или иные насильственные действия", penalty: "Штраф 12000 и арест" },
            { article: "1.7", violation: "Угроза убийством или причинением тяжкого вреда здоровью", penalty: "Арест" },
            { article: "1.8", violation: "Неоказание помощи больному", penalty: "Штраф 18500" },
            { article: "1.9", violation: "Заведомое оставление без помощи лица", penalty: "Штраф 15000" },
            { article: "2.1", violation: "Похищение человека", penalty: "Арест" },
            { article: "2.2", violation: "Незаконное лишение человека свободы", penalty: "Арест" },
            { article: "2.3", violation: "Клевета", penalty: "Штраф 7800" },
            { article: "3.1", violation: "Дискриминация", penalty: "По ситуации" },
            { article: "3.2", violation: "Незаконное собирание или распространение сведений о частной жизни", penalty: "По ситуации" },
            { article: "3.3", violation: "Нарушение тайны переписки", penalty: "По ситуации" },
            { article: "3.4", violation: "Незаконное проникновение в жилище", penalty: "По ситуации" },
            { article: "3.5", violation: "Неправомерный отказ должностного лица", penalty: "По ситуации" },
            { article: "4.1", violation: "Кража", penalty: "По ситуации" },
            { article: "4.2", violation: "Грабеж", penalty: "По ситуации" },
            { article: "4.3", violation: "Разбой", penalty: "По ситуации" },
            { article: "4.4", violation: "Мошенничество", penalty: "По ситуации" },
            { article: "4.5", violation: "Вымогательство", penalty: "По ситуации" },
            { article: "4.6", violation: "Умышленные уничтожение или повреждение чужого имущества", penalty: "По ситуации" },
            { article: "5.1", violation: "Террористический акт", penalty: "По ситуации" },
            { article: "5.2", violation: "Содействие террористической деятельности", penalty: "По ситуации" },
            { article: "5.3", violation: "Несообщение в органы власти о преступлении", penalty: "По ситуации" },
            { article: "5.4", violation: "Захват или удержание лица в качестве заложника", penalty: "По ситуации" },
            { article: "5.5", violation: "Заведомо ложное сообщение о готовящихся взрыве", penalty: "По ситуации" },
            { article: "5.6", violation: "Создание устойчивой вооруженной группы (банды)", penalty: "По ситуации" },
            { article: "5.7", violation: "Организация преступного сообщества", penalty: "По ситуации" },
            { article: "5.8", violation: "Занятие высшего положения в преступной иерархии", penalty: "По ситуации" },
            { article: "5.9", violation: "Организация массовых беспорядков", penalty: "По ситуации" },
            { article: "5.10", violation: "Хулиганство", penalty: "По ситуации" },
            { article: "5.11", violation: "Вандализм", penalty: "По ситуации" },
            { article: "5.12.1", violation: "Незаконное проникновение на охраняемый объект", penalty: "По ситуации" },
            { article: "5.12.2", violation: "Неоднократное проникновение на служебную территорию", penalty: "По ситуации" },
            { article: "5.13", violation: "Незаконные приобретение, передача огнестрельного оружия", penalty: "По ситуации" },
            { article: "5.14", violation: "Незаконные использование или применение огнестрельного оружия", penalty: "По ситуации" },
            { article: "5.15", violation: "Ношение оружия в открытом виде в общественных местах", penalty: "По ситуации" },
            { article: "6.1", violation: "Нарушение ПДД, повлекшее тяжкий вред здоровью", penalty: "По ситуации" },
            { article: "6.2", violation: "Нарушение ПДД, повлекшее смерть", penalty: "По ситуации" },
            { article: "7.1", violation: "Посягательство на жизнь сотрудника правоохранительного органа", penalty: "По ситуации" },
            { article: "7.2", violation: "Применения насилия в отношении представителя власти", penalty: "По ситуации" },
            { article: "7.3", violation: "Оскорбление представителя власти", penalty: "По ситуации" },
            { article: "8.1.1", violation: "Заведомо ложный донос о совершении преступления", penalty: "По ситуации" },
            { article: "8.1.2", violation: "Дача заведомо ложных показаний при допросе", penalty: "По ситуации" },
            { article: "8.1.3", violation: "Дача заведомо ложных показаний в суде", penalty: "По ситуации" },
            { article: "8.2.1", violation: "Неуважение к суду", penalty: "Штраф 20000" },
            { article: "8.2.2", violation: "Оскорбление судьи, присяжного заседателя", penalty: "Штраф 25000 или арест" },
            { article: "8.3", violation: "Укрывательство от преступлений", penalty: "По ситуации" },
            { article: "8.4", violation: "Побег из места лишения свободы", penalty: "По ситуации" },
            { article: "9.1", violation: "Вооруженный мятеж", penalty: "По ситуации" },
            { article: "9.2", violation: "Превышение должностных полномочий", penalty: "По ситуации" },
            { article: "9.3", violation: "Незаконное присвоение звания", penalty: "По ситуации" },
            { article: "9.4", violation: "Получение взятки", penalty: "По ситуации" },
            { article: "9.5", violation: "Дача взятки", penalty: "По ситуации" },
            { article: "9.6", violation: "Халатность", penalty: "По ситуации" },
            { article: "9.7", violation: "Разглашение государственной тайны", penalty: "По ситуации" },
            { article: "10.1", violation: "Незаконные изготовление, приобретение, продажа, хранение наркотических веществ", penalty: "По ситуации" },
            { article: "10.2", violation: "Незаконные приобретение, хранение, перевозка наркотических средств", penalty: "Штраф 10000 + арест" }
        ];

        // Категории ВУ
        const licenseCategories = ["A", "A1", "M", "B", "B1", "C", "D"];

        // Глобальные переменные для хранения данных
        let actions = JSON.parse(localStorage.getItem('mvd_actions')) || [];
        let licenses = JSON.parse(localStorage.getItem('mvd_licenses')) || [];
        let reports = JSON.parse(localStorage.getItem('mvd_reports')) || [];
        let gameDay = parseInt(localStorage.getItem('mvd_gameDay')) || 1;

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация навигации
            initNavigation();
            
            // Инициализация системы
            initSystem();
            
            // Загрузка данных
            loadDashboard();
            loadActionsTable();
            loadLicensesTable();
            loadReports();
            
            // Обновление статистики
            updateStats();
        });

        // Инициализация навигации
        function initNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Убираем активный класс у всех элементов
                    navItems.forEach(i => i.classList.remove('active'));
                    // Добавляем активный класс текущему элементу
                    this.classList.add('active');
                    
                    // Получаем секцию для отображения
                    const sectionId = this.getAttribute('data-section');
                    showSection(sectionId);
                });
            });
            
            // Инициализация быстрых действий
            document.getElementById('quick-vehicle-btn').addEventListener('click', function() {
                showSection('actions');
                document.getElementById('action-type-select').value = 'vehicle';
                showActionForm('vehicle');
            });
            
            document.getElementById('quick-pedestrian-btn').addEventListener('click', function() {
                showSection('actions');
                document.getElementById('action-type-select').value = 'pedestrian';
                showActionForm('pedestrian');
            });
            
            document.getElementById('quick-arrest-btn').addEventListener('click', function() {
                showSection('actions');
                document.getElementById('action-type-select').value = 'arrest';
                showActionForm('arrest');
            });
            
            document.getElementById('quick-accident-btn').addEventListener('click', function() {
                showSection('actions');
                document.getElementById('action-type-select').value = 'accident';
                showActionForm('accident');
            });
        }

        // Инициализация системы
        function initSystem() {
            // Инициализация счетчика дней
            document.getElementById('game-day').textContent = gameDay;
            document.getElementById('increase-day').addEventListener('click', function() {
                gameDay++;
                document.getElementById('game-day').textContent = gameDay;
                localStorage.setItem('mvd_gameDay', gameDay.toString());
                updateLicenseStatuses();
                loadLicensesTable();
                updateStats();
            });
            
            document.getElementById('decrease-day').addEventListener('click', function() {
                if (gameDay > 1) {
                    gameDay--;
                    document.getElementById('game-day').textContent = gameDay;
                    localStorage.setItem('mvd_gameDay', gameDay.toString());
                    updateLicenseStatuses();
                    loadLicensesTable();
                    updateStats();
                }
            });
            
            // Инициализация входа в систему
            document.getElementById('login-btn').addEventListener('click', function() {
                const password = document.getElementById('password-input').value;
                if (password === '121212') {
                    document.getElementById('login-screen').classList.add('hidden');
                    document.getElementById('app-container').classList.remove('hidden');
                } else {
                    document.getElementById('login-error').classList.remove('hidden');
                }
            });
            
            // Инициализация создания действий
            document.getElementById('new-action-btn').addEventListener('click', function() {
                const actionType = document.getElementById('action-type-select').value;
                showActionForm(actionType);
            });
            
            // Инициализация ВУ
            document.getElementById('add-license-btn').addEventListener('click', function() {
                showLicenseForm();
            });
            
            document.getElementById('cancel-license-btn').addEventListener('click', function() {
                document.getElementById('license-form').classList.add('hidden');
            });
            
            document.getElementById('license-data-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveLicense();
            });
            
            // Инициализация поиска ВУ
            document.getElementById('license-search').addEventListener('input', function() {
                filterLicensesTable(this.value);
            });
            
            // Инициализация отчетов
            document.getElementById('generate-arrest-report-btn').addEventListener('click', function() {
                generateArrestReport();
            });
            
            document.getElementById('generate-accident-report-btn').addEventListener('click', function() {
                generateAccidentReport();
            });
            
            document.getElementById('generate-license-report-btn').addEventListener('click', function() {
                generateLicenseReport();
            });
        }

        // Показать секцию
        function showSection(sectionId) {
            // Скрываем все секции
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Показываем выбранную секцию
            document.getElementById(`${sectionId}-section`).classList.add('active');
            
            // Обновляем заголовок страницы
            const titles = {
                'dashboard': 'Главная панель',
                'actions': 'Реестр служебных действий',
                'licenses': 'Водительские удостоверения',
                'reports': 'Отчеты'
            };
            document.getElementById('page-title').textContent = titles[sectionId] || 'МВД РФ';
        }

        // Показать форму действия
        function showActionForm(actionType) {
            const container = document.getElementById('action-forms-container');
            container.innerHTML = '';
            
            if (actionType === 'vehicle') {
                container.innerHTML = getVehicleFormHTML();
                initVehicleForm();
            } else if (actionType === 'pedestrian') {
                container.innerHTML = getPedestrianFormHTML();
                initPedestrianForm();
            } else if (actionType === 'arrest') {
                container.innerHTML = getArrestFormHTML();
                initArrestForm();
            } else if (actionType === 'accident') {
                container.innerHTML = getAccidentFormHTML();
                initAccidentForm();
            }
            
            container.classList.remove('hidden');
        }

        // Загрузка главной панели
        function loadDashboard() {
            const recentActions = actions.slice(-5).reverse();
            const tbody = document.querySelector('#recent-actions-table tbody');
            tbody.innerHTML = '';
            
            if (recentActions.length === 0) {
                document.getElementById('recent-actions-empty').classList.remove('hidden');
                return;
            } else {
                document.getElementById('recent-actions-empty').classList.add('hidden');
            }
            
            recentActions.forEach(action => {
                const tr = document.createElement('tr');
                
                let objectText = '';
                if (action.type === 'vehicle') {
                    objectText = action.vehicle ? `${action.vehicle.brand} ${action.vehicle.model} (${action.vehicle.plate})` : '-';
                } else if (action.type === 'pedestrian' || action.type === 'arrest') {
                    objectText = action.citizen ? `${action.citizen.name} ${action.citizen.patronymic}` : '-';
                } else if (action.type === 'accident') {
                    objectText = action.location || '-';
                }
                
                tr.innerHTML = `
                    <td>${action.id}</td>
                    <td>${action.date}</td>
                    <td>${getActionTypeText(action.type)}</td>
                    <td>${getActionText(action)}</td>
                    <td>${objectText}</td>
                    <td>${action.inspector}</td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        // Загрузка таблицы действий
        function loadActionsTable() {
            const tbody = document.querySelector('#actions-table tbody');
            tbody.innerHTML = '';
            
            if (actions.length === 0) {
                document.getElementById('actions-empty').classList.remove('hidden');
                return;
            } else {
                document.getElementById('actions-empty').classList.add('hidden');
            }
            
            actions.forEach(action => {
                const tr = document.createElement('tr');
                
                let objectText = '';
                if (action.type === 'vehicle') {
                    objectText = action.vehicle ? `${action.vehicle.brand} ${action.vehicle.model} (${action.vehicle.plate})` : '-';
                } else if (action.type === 'pedestrian' || action.type === 'arrest') {
                    objectText = action.citizen ? `${action.citizen.name} ${action.citizen.patronymic}` : '-';
                } else if (action.type === 'accident') {
                    objectText = action.location || '-';
                }
                
                tr.innerHTML = `
                    <td>${action.id}</td>
                    <td>${action.date}</td>
                    <td>${getActionTypeText(action.type)}</td>
                    <td>${getActionText(action)}</td>
                    <td>${action.reason}</td>
                    <td>${objectText}</td>
                    <td>${action.inspector}</td>
                    <td class="action-buttons">
                        <button class="btn" onclick="editAction('${action.id}')"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-danger" onclick="deleteAction('${action.id}')"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        // Загрузка таблицы ВУ
        function loadLicensesTable() {
            const tbody = document.querySelector('#licenses-table tbody');
            tbody.innerHTML = '';
            
            if (licenses.length === 0) {
                document.getElementById('licenses-empty').classList.remove('hidden');
                return;
            } else {
                document.getElementById('licenses-empty').classList.add('hidden');
            }
            
            licenses.forEach(license => {
                const isActive = license.validGameDay >= gameDay;
                const statusText = isActive ? 'Действительно' : 'Недействительно';
                const statusClass = isActive ? 'status-active' : 'status-inactive';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${license.number}</td>
                    <td>${license.name} ${license.patronymic}</td>
                    <td>${license.passport}</td>
                    <td>${license.issueDate} (${license.issueGameDay})</td>
                    <td>${license.validDate} (${license.validGameDay})</td>
                    <td>
                        <div class="categories">
                            ${license.categories.map(cat => `<span class="category">${cat}</span>`).join('')}
                        </div>
                    </td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td class="action-buttons">
                        <button class="btn" onclick="editLicense('${license.id}')"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-danger" onclick="deleteLicense('${license.id}')"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        // Загрузка отчетов
        function loadReports() {
            const container = document.getElementById('reports-container');
            container.innerHTML = '';
            
            if (reports.length === 0) {
                document.getElementById('reports-empty').classList.remove('hidden');
                return;
            } else {
                document.getElementById('reports-empty').classList.add('hidden');
            }
            
            reports.forEach(report => {
                const reportCard = document.createElement('div');
                reportCard.className = 'report-card';
                reportCard.innerHTML = `
                    <div class="report-header">
                        <div class="report-title">${report.title}</div>
                        <div class="report-meta">${report.date} | Сформировал: ${report.inspector}</div>
                    </div>
                    <div class="report-content">
                        ${report.content}
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="viewReport('${report.id}')"><i class="fas fa-eye"></i></button>
                        <button class="btn btn-danger" onclick="deleteReport('${report.id}')"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                container.appendChild(reportCard);
            });
        }

        // Обновление статистики
        function updateStats() {
            document.getElementById('total-actions').textContent = actions.length;
            document.getElementById('total-licenses').textContent = licenses.length;
            
            const activeLicenses = licenses.filter(license => license.validGameDay >= gameDay).length;
            const expiredLicenses = licenses.length - activeLicenses;
            
            document.getElementById('active-licenses').textContent = activeLicenses;
            document.getElementById('expired-licenses').textContent = expiredLicenses;
        }

        // Обновление статусов ВУ
        function updateLicenseStatuses() {
            // Статусы обновляются динамически при загрузке таблицы
        }

        // Фильтрация таблицы ВУ
        function filterLicensesTable(searchText) {
            const rows = document.querySelectorAll('#licenses-table tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                if (text.includes(searchText.toLowerCase())) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Генерация отчета об арестах
        function generateArrestReport() {
            const arrestActions = actions.filter(a => a.type === 'arrest');
            
            if (arrestActions.length === 0) {
                showAlert('Нет данных об арестах для формирования отчета', 'error');
                return;
            }
            
            let content = `
                <div class="report-section">
                    <div class="report-label">Общее количество арестов:</div>
                    <div class="report-value">${arrestActions.length}</div>
                </div>
                <div class="report-section">
                    <div class="report-label">Типы арестов:</div>
                    <div class="report-value">
            `;
            
            const arrestTypes = {};
            arrestActions.forEach(action => {
                if (arrestTypes[action.arrestType]) {
                    arrestTypes[action.arrestType]++;
                } else {
                    arrestTypes[action.arrestType] = 1;
                }
            });
            
            for (const type in arrestTypes) {
                content += `<div>${getArrestTypeText(type)}: ${arrestTypes[type]}</div>`;
            }
            
            content += `
                    </div>
                </div>
                <div class="report-section">
                    <div class="report-label">Последние аресты:</div>
                    <div class="report-value">
            `;
            
            // Показать последние 5 арестов
            const recentArrests = arrestActions.slice(-5);
            recentArrests.forEach(arrest => {
                content += `<div>${arrest.date} - ${arrest.citizen.name} ${arrest.citizen.patronymic} (${arrest.reason})</div>`;
            });
            
            content += `
                    </div>
                </div>
            `;
            
            const report = {
                id: generateId(),
                title: 'Отчет об арестах',
                date: new Date().toLocaleDateString('ru-RU'),
                inspector: 'Система',
                content: content
            };
            
            reports.push(report);
            localStorage.setItem('mvd_reports', JSON.stringify(reports));
            loadReports();
            showAlert('Отчет об арестах успешно сформирован!', 'success');
        }

        // Генерация отчета о ДТП
        function generateAccidentReport() {
            const accidentActions = actions.filter(a => a.type === 'accident');
            
            if (accidentActions.length === 0) {
                showAlert('Нет данных о ДТП для формирования отчета', 'error');
                return;
            }
            
            let content = `
                <div class="report-section">
                    <div class="report-label">Общее количество ДТП:</div>
                    <div class="report-value">${accidentActions.length}</div>
                </div>
                <div class="report-section">
                    <div class="report-label">Тяжесть ДТП:</div>
                    <div class="report-value">
            `;
            
            const severityCount = {};
            accidentActions.forEach(action => {
                if (severityCount[action.severity]) {
                    severityCount[action.severity]++;
                } else {
                    severityCount[action.severity] = 1;
                }
            });
            
            for (const severity in severityCount) {
                content += `<div>${getAccidentSeverityText(severity)}: ${severityCount[severity]}</div>`;
            }
            
            content += `
                    </div>
                </div>
                <div class="report-section">
                    <div class="report-label">Типы ДТП:</div>
                    <div class="report-value">
            `;
            
            const typeCount = {};
            accidentActions.forEach(action => {
                if (typeCount[action.accidentType]) {
                    typeCount[action.accidentType]++;
                } else {
                    typeCount[action.accidentType] = 1;
                }
            });
            
            for (const type in typeCount) {
                content += `<div>${getAccidentTypeText(type)}: ${typeCount[type]}</div>`;
            }
            
            content += `
                    </div>
                </div>
                <div class="report-section">
                    <div class="report-label">Последние ДТП:</div>
                    <div class="report-value">
            `;
            
            // Показать последние 5 ДТП
            const recentAccidents = accidentActions.slice(-5);
            recentAccidents.forEach(accident => {
                content += `<div>${accident.date} ${accident.time} - ${accident.location} (${getAccidentSeverityText(accident.severity)})</div>`;
            });
            
            content += `
                    </div>
                </div>
            `;
            
            const report = {
                id: generateId(),
                title: 'Отчет о ДТП',
                date: new Date().toLocaleDateString('ru-RU'),
                inspector: 'Система',
                content: content
            };
            
            reports.push(report);
            localStorage.setItem('mvd_reports', JSON.stringify(reports));
            loadReports();
            showAlert('Отчет о ДТП успешно сформирован!', 'success');
        }

        // Генерация отчета по ВУ
        function generateLicenseReport() {
            if (licenses.length === 0) {
                showAlert('Нет данных о ВУ для формирования отчета', 'error');
                return;
            }
            
            const activeLicenses = licenses.filter(license => license.validGameDay >= gameDay).length;
            const expiredLicenses = licenses.length - activeLicenses;
            
            let content = `
                <div class="report-section">
                    <div class="report-label">Общее количество ВУ:</div>
                    <div class="report-value">${licenses.length}</div>
                </div>
                <div class="report-section">
                    <div class="report-label">Действующие ВУ:</div>
                    <div class="report-value">${activeLicenses}</div>
                </div>
                <div class="report-section">
                    <div class="report-label">Просроченные ВУ:</div>
                    <div class="report-value">${expiredLicenses}</div>
                </div>
                <div class="report-section">
                    <div class="report-label">Распределение по категориям:</div>
                    <div class="report-value">
            `;
            
            const categoryCount = {};
            licenses.forEach(license => {
                license.categories.forEach(category => {
                    if (categoryCount[category]) {
                        categoryCount[category]++;
                    } else {
                        categoryCount[category] = 1;
                    }
                });
            });
            
            for (const category in categoryCount) {
                content += `<div>Категория ${category}: ${categoryCount[category]}</div>`;
            }
            
            content += `
                    </div>
                </div>
            `;
            
            const report = {
                id: generateId(),
                title: 'Отчет по водительским удостоверениям',
                date: new Date().toLocaleDateString('ru-RU'),
                inspector: 'Система',
                content: content
            };
            
            reports.push(report);
            localStorage.setItem('mvd_reports', JSON.stringify(reports));
            loadReports();
            showAlert('Отчет по ВУ успешно сформирован!', 'success');
        }

        // Вспомогательные функции
        function generateId() {
            return 'ID-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        function getActionTypeText(type) {
            const types = {
                'vehicle': 'ТС',
                'pedestrian': 'Пеший',
                'arrest': 'Арест',
                'accident': 'ДТП'
            };
            return types[type] || type;
        }

        function getActionText(action) {
            if (action.type === 'vehicle') {
                const actions = {
                    'stop': 'Остановка Т/С',
                    'arrest': 'Арест гражданина',
                    'fine': 'Административный штраф',
                    'license-revoke': 'Лишение водительского удостоверения'
                };
                return actions[action.action] || action.action;
            } else if (action.type === 'pedestrian') {
                const actions = {
                    'check': 'Проверка документов',
                    'fine': 'Административный штраф',
                    'warning': 'Предупреждение',
                    'detain': 'Задержание'
                };
                return actions[action.action] || action.action;
            } else if (action.type === 'arrest') {
                return 'Арест';
            } else if (action.type === 'accident') {
                return 'Оформление ДТП';
            }
            return action.action;
        }

        function getArrestTypeText(type) {
            const types = {
                'administrative': 'Административный арест',
                'criminal': 'Уголовный арест',
                'preventive': 'Превентивный арест'
            };
            return types[type] || type;
        }

        function getAccidentSeverityText(severity) {
            const types = {
                'light': 'Легкое',
                'medium': 'Среднее',
                'severe': 'Тяжелое'
            };
            return types[severity] || severity;
        }

        function getAccidentTypeText(type) {
            const types = {
                'collision': 'Столкновение',
                'rollover': 'Опрокидывание',
                'pedestrian': 'Наезд на пешехода',
                'obstacle': 'Наезд на препятствие',
                'other': 'Иной вид ДТП'
            };
            return types[type] || type;
        }

        function showAlert(message, type) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                <div>${message}</div>
            `;
            
            document.querySelector('.content').insertBefore(alert, document.querySelector('.content').firstChild);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // Функции для работы с действиями
        function editAction(id) {
            const action = actions.find(a => a.id === id);
            if (action) {
                showSection('actions');
                document.getElementById('action-type-select').value = action.type;
                showActionForm(action.type);
                // Здесь должна быть логика заполнения формы данными действия
                // Для простоты опустим эту часть
            }
        }

        function deleteAction(id) {
            if (confirm('Вы уверены, что хотите удалить это действие?')) {
                actions = actions.filter(a => a.id !== id);
                localStorage.setItem('mvd_actions', JSON.stringify(actions));
                loadActionsTable();
                loadDashboard();
                updateStats();
                showAlert('Действие удалено!', 'success');
            }
        }

        // Функции для работы с ВУ
        function showLicenseForm(license = null) {
            const form = document.getElementById('license-form');
            form.classList.remove('hidden');
            
            if (license) {
                // Редактирование существующего ВУ
                document.getElementById('license-id').value = license.id;
                document.getElementById('license-name').value = license.name;
                document.getElementById('license-patronymic').value = license.patronymic;
                document.getElementById('license-passport').value = license.passport;
                document.getElementById('license-number').value = license.number;
                document.getElementById('license-issue-date').value = license.issueDate;
                document.getElementById('license-issue-game-day').value = license.issueGameDay;
                document.getElementById('license-valid-date').value = license.validDate;
                document.getElementById('license-valid-game-day').value = license.validGameDay;
                
                // Снимаем все галочки категорий
                document.querySelectorAll('input[name="license-category"]').forEach(cb => {
                    cb.checked = false;
                });
                
                // Ставим галочки на нужные категории
                license.categories.forEach(cat => {
                    const checkbox = document.querySelector(`input[name="license-category"][value="${cat}"]`);
                    if (checkbox) checkbox.checked = true;
                });
            } else {
                // Создание нового ВУ
                document.getElementById('license-id').value = generateId();
                document.getElementById('license-issue-date').value = new Date().toLocaleDateString('ru-RU');
                document.getElementById('license-issue-game-day').value = gameDay;
                
                // Устанавливаем дату окончания на 10 лет вперед
                const futureDate = new Date();
                futureDate.setFullYear(futureDate.getFullYear() + 10);
                document.getElementById('license-valid-date').value = futureDate.toLocaleDateString('ru-RU');
                document.getElementById('license-valid-game-day').value = gameDay + 3650;
                
                // Снимаем все галочки категорий
                document.querySelectorAll('input[name="license-category"]').forEach(cb => {
                    cb.checked = false;
                });
            }
        }

        function saveLicense() {
            const selectedCategories = Array.from(document.querySelectorAll('input[name="license-category"]:checked'))
                .map(cb => cb.value);
            
            const license = {
                id: document.getElementById('license-id').value,
                name: document.getElementById('license-name').value,
                patronymic: document.getElementById('license-patronymic').value,
                passport: document.getElementById('license-passport').value,
                number: document.getElementById('license-number').value,
                issueDate: document.getElementById('license-issue-date').value,
                issueGameDay: parseInt(document.getElementById('license-issue-game-day').value),
                validDate: document.getElementById('license-valid-date').value,
                validGameDay: parseInt(document.getElementById('license-valid-game-day').value),
                categories: selectedCategories
            };
            
            // Проверяем, это новое ВУ или редактирование
            const existingIndex = licenses.findIndex(l => l.id === license.id);
            if (existingIndex >= 0) {
                licenses[existingIndex] = license;
            } else {
                licenses.push(license);
            }
            
            localStorage.setItem('mvd_licenses', JSON.stringify(licenses));
            
            // Очистка формы
            document.getElementById('license-data-form').reset();
            document.getElementById('license-form').classList.add('hidden');
            
            // Обновление таблицы
            loadLicensesTable();
            
            // Обновление статистики
            updateStats();
            
            // Показать уведомление
            showAlert('Водительское удостоверение успешно сохранено!', 'success');
        }

        function editLicense(id) {
            const license = licenses.find(l => l.id === id);
            if (license) {
                showLicenseForm(license);
            }
        }

        function deleteLicense(id) {
            if (confirm('Вы уверены, что хотите удалить это водительское удостоверение?')) {
                licenses = licenses.filter(l => l.id !== id);
                localStorage.setItem('mvd_licenses', JSON.stringify(licenses));
                loadLicensesTable();
                updateStats();
                showAlert('Водительское удостоверение удалено!', 'success');
            }
        }

        // Функции для работы с отчетами
        function viewReport(id) {
            const report = reports.find(r => r.id === id);
            if (report) {
                alert(`Отчет: ${report.title}\n\nДата формирования: ${report.date}\nСформировал: ${report.inspector}\n\nСодержание:\n${report.content}`);
            }
        }

        function deleteReport(id) {
            if (confirm('Вы уверены, что хотите удалить этот отчет?')) {
                reports = reports.filter(r => r.id !== id);
                localStorage.setItem('mvd_reports', JSON.stringify(reports));
                loadReports();
                showAlert('Отчет удален!', 'success');
            }
        }

        // Функции для форм действий (упрощенные версии)
        function getVehicleFormHTML() {
            return `
                <div class="card">
                    <form id="vehicle-action-form">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-car"></i> Оформление остановки ТС</h2>
                        </div>
                        
                        <div class="form-section">
                            <h3 class="card-title"><i class="fas fa-info-circle"></i> Основные сведения</h3>
                            <div class="form-group">
                                <label for="vehicle-action-id">Уникальный номер записи</label>
                                <input type="text" id="vehicle-action-id" readonly>
                            </div>
                            
                            <div class="form-group">
                                <label for="vehicle-action-type">Действие *</label>
                                <select id="vehicle-action-type" required>
                                    <option value="">Выберите действие</option>
                                    <option value="stop">Остановка Т/С</option>
                                    <option value="fine">Административный штраф</option>
                                    <option value="arrest">Арест гражданина</option>
                                    <option value="license-revoke">Лишение водительского удостоверения</option>
                                </select>
                            </div>
                            
                            <div class="form-group" id="vehicle-fine-amount-container" style="display: none;">
                                <label for="vehicle-fine-amount">Сумма штрафа *</label>
                                <input type="number" id="vehicle-fine-amount" min="0">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3 class="card-title"><i class="fas fa-car-side"></i> Сведения о транспортном средстве</h3>
                            <div class="flex">
                                <div class="form-group flex-1">
                                    <label for="vehicle-brand">Марка *</label>
                                    <input type="text" id="vehicle-brand" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label for="vehicle-model">Модель *</label>
                                    <input type="text" id="vehicle-model" required>
                                </div>
                            </div>
                            
                            <div class="flex">
                                <div class="form-group flex-1">
                                    <label for="vehicle-color">Цвет *</label>
                                    <input type="text" id="vehicle-color" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label for="vehicle-plate">Госномер *</label>
                                    <input type="text" id="vehicle-plate" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3 class="card-title"><i class="fas fa-user"></i> Сведения о владельце</h3>
                            <div class="flex">
                                <div class="form-group flex-1">
                                    <label for="vehicle-owner-name">Имя *</label>
                                    <input type="text" id="vehicle-owner-name" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label for="vehicle-owner-patronymic">Отчество *</label>
                                    <input type="text" id="vehicle-owner-patronymic" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="vehicle-owner-passport">№ Паспорта *</label>
                                <input type="text" id="vehicle-owner-passport" required>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Дата и инспектор</h3>
                            <div class="form-group">
                                <label for="vehicle-inspector-name">Инспектор *</label>
                                <input type="text" id="vehicle-inspector-name" required>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn"><i class="fas fa-save"></i> Сохранить действие</button>
                            <button type="button" class="btn btn-danger" id="cancel-vehicle-action-btn"><i class="fas fa-times"></i> Отмена</button>
                        </div>
                    </form>
                </div>
            `;
        }

        function initVehicleForm() {
            document.getElementById('vehicle-action-id').value = generateId();
            document.getElementById('vehicle-inspector-name').value = 'Инспектор И.О.';
            
            document.getElementById('vehicle-action-type').addEventListener('change', function() {
                const fineContainer = document.getElementById('vehicle-fine-amount-container');
                if (this.value === 'fine') {
                    fineContainer.style.display = 'block';
                } else {
                    fineContainer.style.display = 'none';
                }
            });
            
            document.getElementById('cancel-vehicle-action-btn').addEventListener('click', function() {
                document.getElementById('action-forms-container').classList.add('hidden');
            });
            
            document.getElementById('vehicle-action-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const action = {
                    id: document.getElementById('vehicle-action-id').value,
                    date: new Date().toLocaleDateString('ru-RU'),
                    gameDay: gameDay,
                    type: 'vehicle',
                    action: document.getElementById('vehicle-action-type').value,
                    vehicle: {
                        brand: document.getElementById('vehicle-brand').value,
                        model: document.getElementById('vehicle-model').value,
                        color: document.getElementById('vehicle-color').value,
                        plate: document.getElementById('vehicle-plate').value
                    },
                    owner: {
                        name: document.getElementById('vehicle-owner-name').value,
                        patronymic: document.getElementById('vehicle-owner-patronymic').value,
                        passport: document.getElementById('vehicle-owner-passport').value
                    },
                    inspector: document.getElementById('vehicle-inspector-name').value,
                    fineAmount: document.getElementById('vehicle-fine-amount').value || null
                };
                
                // Для простоты генерируем случайную статью
                const randomCodex = [...administrativeCode, ...roadCode][Math.floor(Math.random() * (administrativeCode.length + roadCode.length))];
                action.reason = `${randomCodex.article} - ${randomCodex.violation}`;
                
                actions.push(action);
                localStorage.setItem('mvd_actions', JSON.stringify(actions));
                
                document.getElementById('action-forms-container').classList.add('hidden');
                loadActionsTable();
                loadDashboard();
                updateStats();
                showAlert('Действие успешно сохранено!', 'success');
            });
        }

        // Аналогичные функции для других типов действий (pedestrian, arrest, accident)
        // Для экономии места приведем только заглушки
        
        function getPedestrianFormHTML() {
            return `<div class="card"><p>Форма оформления пешего гражданина</p></div>`;
        }
        
        function initPedestrianForm() {
            // Инициализация формы пешего гражданина
        }
        
        function getArrestFormHTML() {
            return `<div class="card"><p>Форма оформления ареста</p></div>`;
        }
        
        function initArrestForm() {
            // Инициализация формы ареста
        }
        
        function getAccidentFormHTML() {
            return `<div class="card"><p>Форма оформления ДТП</p></div>`;
        }
        
        function initAccidentForm() {
            // Инициализация формы ДТП
        }
    </script>
</body>
</html>
